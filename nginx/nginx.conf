events {
  worker_connections  1024;
}

## MONGODB USE Stream Only
stream {
  server {
      listen  27017 so_keepalive=on;
      proxy_connect_timeout 2s;
      proxy_pass    stream_mongo_backend;
      proxy_timeout 10m;
  }
  upstream stream_mongo_backend {
       server 10.171.0.83:27017;
  }

  ## Redis
  server {
      listen  6379 so_keepalive=on;
      proxy_connect_timeout 2s;
      proxy_pass    redis;
      proxy_timeout 10m;
  }
  upstream redis {
       server 10.171.0.82:6379;
  }

  # SFTP
  server {
      listen  2223 so_keepalive=on;
      proxy_connect_timeout 2s;
      proxy_pass    sftp;
      proxy_timeout 10m;
  }
  upstream sftp {
       server 10.200.125.110:22;
  }

  ## ORACLE DEV
  server {
      listen  1522 so_keepalive=on;
      proxy_connect_timeout 2s;
      proxy_pass    oracle;
      proxy_timeout 10m;
  }
  upstream oracle {
       server 10.209.33.52:1522;
  }
}

http {

  ## 7990
  server {
    listen          7990 ssl;
    listen          [::]:7990;
    server_name     bitbucket.tmbbank.local;

    location / {
      proxy_pass       https://10.209.50.20:7990/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

  ## 8081
  server { 
    listen          8081 ssl;
    listen          [::]:8081;
    listen          443 ssl;
    listen          [::]:443;
    server_name     nexus.tmbbank.local;

    location / {
      proxy_pass       https://10.209.50.1:8081/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

  ## jenkins 8443
  server { 
    listen          8443 ssl;
    listen          [::]:8443;
    listen          443 ssl;
    listen          [::]:443;
    server_name     jenkins.tmbbank.local;

    location / {
      proxy_pass       https://10.209.50.21:8443/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

  ## 8070
  server { 
    listen          8070 ssl;
    listen          [::]:8070;
    server_name     confluence.tmbbank.local;

    location / {
      proxy_pass       http://10.209.26.144:8070/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

  ## ELK
  server { 
    listen          5601 ssl;
    listen          [::]:5601;
    server_name     elku.tmbbank.local;

    location / {
      proxy_pass       https://10.209.50.40:5601/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

  ## JIRA
  server { 
    listen          443 ssl;
    listen          [::]:443;
    server_name     jira.tau2904.com;

    location / {
      proxy_pass       https://10.171.0.89:443/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }


  server { 
    listen          9000;
    listen          [::]:9000;
    server_name     sonarqube.tmbbank.local;

    location / {
      proxy_pass       http://10.209.50.21:9000/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }
  }

  server { 
    listen          443 ssl;
    listen          [::]:443;
    server_name     apis-portal.oneapp.tmbbank.local;

    location / {
      proxy_pass       https://apis-portal.oneapp.tmbbank.local:443/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

  server { 
    listen          28000;
    listen          [::]:28000;
    server_name     apis-portal.oneapp.tmbbank.local;

    location / {
      proxy_pass       http://apis-portal.oneapp.tmbbank.local:28000/;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }
  }


  server { 
    listen          15590 ssl;
    listen          [::]:15590;
    server_name     stmetead1.tmbbank.local;

    location / {
      proxy_pass       https://10.200.115.196:15590;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }


  #RSL
  server { 
    listen          9080;
    listen          [::]:9080;
    server_name     localhost;

    location / {
      proxy_pass       http://10.209.27.99:9080;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }
  }


  # DEV API
  server { 
    listen          80;
    listen          [::]:80;
    server_name     localhost;

    location / {
      proxy_pass       http://10.171.0.80:80;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }
  }


  # UAT API
  server { 
    listen          81 ssl;
    listen          [::]:81;
    server_name     localhost;

    location / {
      proxy_pass       https://10.171.243.127:80;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Protocol $scheme;
      proxy_set_header X-Url-Scheme $scheme;
      proxy_redirect off;
    }

    ssl                  on;
    ssl_certificate      /etc/ssl/certificates/local.crt;
    ssl_certificate_key  /etc/ssl/certificates/local.key;
    ssl_ciphers          ALL:!aNull:!eNull:!SSLv2:!kEDH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+EXP:@STRENGTH;
  }

}

